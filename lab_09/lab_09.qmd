#lab_08
Sean Mussenden, Aug 16, 2022

## About this lab

To complete this lab, you need to:
* write code in empty codeblocks provided to answer questions included (look for **Q**).
* write out the answer in the form of a complete sentence in the space given (look for **A**).

When you are finished, commit changes and push to your personal GitHub repo, then submit the URL to this document on ELMS.

## Load libraries and establish settings
**Task**: Load janitor and the tidyverse and sf

```{r}
library(tidyverse)
library(janitor)
library(sf)

```

## Load data

```{r}

balt_homicides <- read_rds("data/baltimore_homicides.rds")
balt_tract_demographics <- read_rds("data/baltimore_tract_demographics.rds")
balt_tract_shapefiles <- read_rds("data/baltimore_tract_shapefiles.rds")


```

You have been given two spatial dataframes and one regular dataframe to load.  The dataframes are:

* baltimore_homicides.rds | spatial | location and details about each Baltimore homicide between 2007 and 2017, including information about the status (open, closed with arrest, closed without arrest) and the exact location. Details on the data: https://github.com/washingtonpost/data-homicides
* baltimore_tract_shapefiles.rds | spatial | polygons of each census tract in Baltimore
* baltimore_tract_demographics.rds | regular | the total population and white population of each baltimore Census tract in 2017.

**Task** Load the data

## Questions

**Q1** Are homicides that occur in majority white Census tracts in Baltimore solved at a higher rate than homicides in non-majority white Baltimore census tracts?
* Write up your findings in three paragraphs that could be dropped into a news story, with the answer to the question as the lede. 
* Include any other relevant details.
* Output a table with relevant results. 
* Output at least one map visualization pertinent to your finding. 

**A1** 



#Mutate and find out majority white vs non-majority white neighborhoods
```{r}
balt_maj_white <- baltimore_tract_demographics %>%
  mutate(pct_white = white_pop/total_pop) %>%
  mutate(neighborhood_type = case_when(
    pct_white > .50 ~ "majority white",
    TRUE ~ "non majority white"))
```

***This made and assigned names to communities that are 50% or more white as majority white.


#Join to Balt Tracts with assigned white and non-white
```{r}
balt_maj_white_geo <- balt_maj_white %>%
  inner_join(baltimore_tract_shapefiles) %>%
  st_as_sf() %>% 
  st_join(baltimore_homicides) %>%
  as_tibble()

balt_maj_white_geo2 <- balt_maj_white %>%
  inner_join(baltimore_tract_shapefiles) %>%
  st_as_sf() %>% 
  as_tibble()
```

***This joined the previous to a geocoded tract of neighborhoods with the mutates non-white and white and the homicides
***The second one with the 2 on it has no homicides attached if I just wanted to map for neighborhoods majority or non-majority white 

#map of homicides
```{r}
ggplot() +
  geom_sf(data=baltimore_tract_shapefiles) +
  geom_sf(data=baltimore_homicides) 

```

***This shows that a majority of homicides are out on the Black butterfly.



#Assign neighborhoods to disposition
```{r}
dispos_balt_maj_white_geo <- balt_maj_white_geo %>% 
  group_by(neighborhood_type, disposition) %>% 
  count(neighborhood_type, disposition) %>% 
  clean_names() 

dispos_balt_maj_white_geo <- dispos_balt_maj_white_geo %>% 
  pivot_wider(names_from=disposition, values_from=n) %>%
  clean_names() %>%
  mutate(total = closed_by_arrest+closed_without_arrest+open_no_arrest) %>%
  mutate(unsolved = open_no_arrest + closed_without_arrest) %>%
  mutate(pct_unsolved = unsolved/total*100)

```

***This took neighborhoods and found out how cases were closed in each community


#Some analysis
```{r}
sum(dispos_balt_maj_white_geo$closed_by_arrest) = 1002
  #percent of closed by arrest that were in majority white neighborhoods: 128/1002= 13%
  #percent of closed by arrest that were in non majority white neighborhoods: 874/1002= 87%

sum(dispos_balt_maj_white_geo$closed_without_arrest) = 152
  #percent of closed without arrest that were in majority white neighborhoods: 15/152= 10%
  #percent of closed without arrest that were in non majority white neighborhoods: 137/152= 90%

sum(dispos_balt_maj_white_geo$open_no_arrest) =1673
  #percent of opened no arrest that were in majority white neighborhoods: 96/1673= 6%
  #percent of opened no arrest that were in non majority white neighborhoods: 1577/1673= 94%

sum(dispos_balt_maj_white_geo$total)= 2827
  #percent of all homicides in majority white neighborhoods: 239/2827= 8%
  #percent of all homicides in non majority white neighborhoods: 2588/2827= 92%

sum(dispos_balt_maj_white_geo$unsolved) =1825
  #percent of all homicides in majority white neighborhoods: 111/1825= 6%
  #percent of all homicides in non majority white neighborhoods: 1714/1825= 94%
```

Are homicides that occur in majority white Census tracts in Baltimore solved at a higher rate than homicides in non-majority white Baltimore census tracts?


#Three paragraphs
***Homicides in majority white neighborhoods in Baltimore were solved at higher rates than their frequency of total homicides in the city, according to an analysis of Census data of Baltimore homicides from 2007-2018.

***Of the 2827 homicides in Baltimore at that time, 8% occured in majority white neighborhoods and 92% occured in neighborhoods that were not majority white. For majority white neighborhoods, the amount of unresolved cases was below that total, falling 2 percentage points to only 6% of total unresolved cases. 13% of total cases closed by arrest and 10% of cases closed without arrest occured in majority white neighborhoods.

***insert map from above

***According to this map, a majority of homicides in the city occured in neighborhoods on what is known as the city's "Black butterfly" -- communities which are historically known for being majority-black population. In comparison to the arrests for homicides of white neighborhoods, the cases in majority non-white communities took shares as follows:
-92% of total homicides in the city
-87% of total cases closed by arrest (5 percentage points below its share of total homicides)
-90% of total cases closed without arrest (2 percentage points below its share of total homicides)
-94% of total cases open with no arrest (4 percentage points above its share of total homicides)
-94% of total unsolved cases(4 percentage points above its share of total homicides)







#Trying to do more
```{r}
ggplot() +
  geom_sf(data=balt_maj_white_geo, aes(fill=neighborhood_type)) 

#Couldn't figure this out for what to put in the fill
```


```

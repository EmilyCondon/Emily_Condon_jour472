#Lab_05  {lab_05}

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## About this lab

To complete this lab, you need to:
* run existing code as directed (look for **Task**).
* modify existing code as directed (look for **Task**).
* write code in empty codeblocks provided to answer questions included (look for **Q**).
* write out the answer in the form of a complete sentence in the space given (look for **A**).

When you are finished, commit changes and push to your personal GitHub repo, then submit the URL to this document on ELMS.

## Load libraries and establish settings

You'll need to load two packages for this: the tidyverse and janitor.

**Task** load these two packages.

```{r}
# Turn off scientific notation
options(scipen=999)

```

### Load Life Expectancy Data

You'll need to load :

CDC_Life_Census_Tract_2010_2015.csv

It is included in your lab_05.zip file.


About the data: 
Life Expectancy at Birth for U.S. States and [Census Tracts, 2010-2015](https://www.cdc.gov/nchs/data-visualization/life-expectancy/index.html) 

It shows estimates of U.S. life expectancy at birth by state and census tract for the period 2010-2015. Estimates were produced for 67,148 census tracts, covering all states and the District of Columbia (D.C.). These estimates come from the National Center for Health Statistics (NCHS), the National Association for Public Health Statistics and Information Systems (NAPHSIS), and the Robert Wood Johnson Foundation (RWJF).


**Task** Create a codeblock below this task, then load the data sets and assign them to appropriate variable names. 

## Answer questions

**Q1.** In your lab_05 folder, there is a csv called CDC_Life_Census_Tract_2010_2015.csv.  It contains all of the life expectancy data for the United States.

You are going to examine this data and learn the range of death rates in Baltimore and then in Maryland in general.

Do the following:
-  Load tidyverse and janitor
-  Load the data CDC_Life_Census_Tract_2010_2015.csv into a dataframe called us_death. 
Include the code to show the number of records. Clean the names using Janitor
-  Filter this according to Maryland into second table called md_death
-  Filter this according to Baltimore City into a third table called balt_death

**A1.**

```{r}
# Load code
library(tidyverse)
library(janitor)
library(dplyr)

# Load data
us_death <- read_csv("CDC_Life_Census_Tract_2010_2015.csv") %>% 
  as.data.frame()

#show the number
us_death %>%
  select(State, County, "Census Tract Number", "Life Expectancy", "Life Expectancy Range") %>%
  mutate(Total_records = nrow(us_death), "\n")

#Answer: There are 73,121 rows

#clean names
us_death <- read_csv("CDC_Life_Census_Tract_2010_2015.csv") %>% 
  select(State, County, "Census Tract Number", "Life Expectancy", "Life Expectancy Range")

us_death <- janitor::clean_names(us_death)

#Filter for MD
md_death <- us_death %>%
  filter(state == "Maryland")

#Filter for Baltimore City
balt_death <- md_death %>%
  filter(county == "Baltimore City, MD")

```

**Q2.** 
For this question, load a modified dataset called balt_death_census.csv.

Call it balt_death2

This has the same information but with the Baltimore neighborhoods. 

Produce summary statistics showing the data distribution by quartile, median, mean, miniumum and maximum values on the life expectancy rate.

Show the neighborhoods with a life expectancy rate below the 1st quartile, arranged in ascending order. 


**A2.** 
```{r}
#Load data
balt_death2 <- read_csv("balt_death_census.csv") %>% 
  as.data.frame()

#Produce summary statistics
balt_death2 %>%
  summary(balt_death2)
#The life expctancy first quartile is 69.58 years

#Neighborhoods with life expectancy below 1st quartile

balt_death2 %>%
  mutate(
    category = case_when(
        life_expectancy >= 69.58 ~ "above",
        life_expectancy <= 69.58 ~ "below",
      )) %>%
    filter(category == "below") %>%
  arrange(category)
  


```

**Q3.** Use md_death, the Maryland life expectancy rates.
Produce summary statistics of the state of Maryland life expectancy rate. 
Produce a table with the 20 communities with the lowest life expectancy. 
Produce a table with the 20 communities with the highest life expectancy. 

Then use us_death, and determine the average life expectancy nationwide.

Then write 150-200 words on this document below your code that compares your findings of Baltimore, the state and nation. 

**A3.**

```{r}
#Produce summary statistics for MD
md_death %>%
  summary(md_death)

#Proude a table with the 20 communities with the lowest life expectancy
md_death %>%
  filter(county != "(blank)") %>%
  arrange(life_expectancy) %>%
  head(n=20)

#Produce a table with the 20 communities with the highest life expectancy
md_death %>%
  filter(county != "(blank)") %>%
  arrange(desc(life_expectancy)) %>%
  head(n=20)

#Use us_deaths for average nationwide
us_death %>%
  summary(us_death)

#The nationwide average life expectancy is 78.31 years.


#150-200 words to compare Baltimore, MD and the nation
#The nationwide average life expectancy is 78.31 years, Maryland's average is around the same at 78.7 years, but Baltimore City's average is 73.04 years, which is about five years below both the state and nation averages. In the nation's 20 lowest life expectancies, major cities (like Baltimore) were New York at 59 years and St. Louis t 60.7 years. The 20th city on this list had a life expectancy of 62 years, but Baltimore was below the nation's first quartile of 75.80 years. In comparison to the state's 20 census tracts with the lowest life expectancy, Baltimore City tracts held 19 out of those 20 spots. The state's first quartile life expectancy was 76.4 years, which is about 3 years higher than Baltimore. So in summary, Baltimore's life expectancy is in the first quartile of both the national and state life expectancies, which means it is in the lower 25% of both. While it is not as low as the nation's worst 20 counties, it did account for almost all of the state's 20 lowest census tracts in life expectancy.


```

**Q4.**

Use balt_death. Use mutate and the case_when command.

Categorize all Baltimore City Census tracts as being above or below the city's average life expectancy rate. 

Then produce a table that summarizes the number of Census tracts above or below the average life expectancy rate. Write two sentences summarizing your findings.

Pro Tip: See this chapter section for a refresher on case_when: https://wellsdata.github.io/data_journalism_class/_book/r-mutating.html#a-more-powerful-use


```{r}
#Find Baltimore's average
balt_death2 %>%
  summary(balt_death2)

#Baltimore's average life expectancy is 73.04 years.

#Mutate to put tracts above and below the average

balt_death2 <- balt_death2 %>%
  mutate(
    above_below = case_when(
        life_expectancy >= 73.04 ~ "above",
        life_expectancy <= 73.04 ~ "below",
      )) 


#Produce table
  
balt_death %>%  
mutate(
    above_below = case_when(
        life_expectancy >= 73.04 ~ "above",
        life_expectancy <= 73.04 ~ "below",
  )) %>% 
  select("county", "census_tract_number" , "life_expectancy", "above_below")


```


